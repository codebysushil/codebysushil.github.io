<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Code By Sushil</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
body{margin:0;font-family:'Inter',sans-serif;background:#0f1720;color:#e6eef8;line-height:1.6;}
.wrap{max-width:1000px;margin:32px auto;padding:20px;}
h1{text-align:center;margin-bottom:32px;}
.articles-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:20px;}
.article-card{background:rgba(255,255,255,0.02);border-radius:14px;padding:20px;border:1px solid rgba(255,255,255,0.03);transition:0.2s;}
.article-card:hover{transform:translateY(-4px);box-shadow:0 12px 24px rgba(0,0,0,0.3);}
.article-card h2{margin-top:0;color:#7c5cff;}
.article-card p{color:#9aa4b2;}
.article-card .meta{font-size:0.85rem;color:#9aa4b2;margin-top:10px;}
.article-card .tags{margin-top:8px;font-size:0.8rem;color:#7c5cff;}
.article-card a{text-decoration:none;color:inherit;}
</style>
</head>
<body>
<div class="wrap">
<h1>Articles</h1>
<div class="articles-grid" id="articles-grid"></div>
</div>

<script>
// --- Helpers ---
function parseFrontMatter(md){
  const fmRegex=/^---\s*([\s\S]*?)\s*---\s*/;
  const match=md.match(fmRegex);
  if(!match) return {fm:{}, content:md};
  const yaml=match[1];
  const content=md.slice(match[0].length);
  const lines=yaml.split(/\r?\n/).map(l=>l.trim()).filter(Boolean);
  const fm={};
  for(const line of lines){
    const m=line.match(/^([A-Za-z0-9\-_]+)\s*:\s*(.*)$/);
    if(m){fm[m[1].toLowerCase()]=m[2].replace(/^["'](.*)["']$/,'$1');}
  }
  return {fm, content};
}
function formatDate(iso){try{const d=new Date(iso);return isNaN(d)?iso:d.toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'});}catch(e){return iso}}

// --- Config ---
const GITHUB_USER='codebysushil';      // your GitHub username
const GITHUB_REPO="codebysushil.github.io";     // your repository name
const ARTICLES_PATH='articles';    // folder containing markdown files
const BRANCH='main';               // default branch

(async function(){
  const grid=document.getElementById('articles-grid');
  try{
    // GitHub API: list files in articles folder
    const apiUrl=`https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/${ARTICLES_PATH}?ref=${BRANCH}`;
    const res=await fetch(apiUrl);
    if(!res.ok) throw new Error('Failed to fetch repo files');
    const files=await res.json();
    const mdFiles=files.filter(f=>f.name.endsWith('.md'));
    
    for(const file of mdFiles){
      try{
        const rawUrl=file.download_url; // direct raw URL
        const resp=await fetch(rawUrl);
        if(!resp.ok) continue;
        const mdText=await resp.text();
        const {fm}=parseFrontMatter(mdText);
        const title=fm.title||file.name;
        const description=fm.description||'';
        const author=fm.author||'Unknown';
        const date=fm.date?formatDate(fm.date):'';
        const tags=fm.tags||'';
        
        const card=document.createElement('a');
        card.href=`pages/article.html?file=${file.name}`;
        card.className='article-card';
        card.innerHTML=`
          <h2>${title}</h2>
          <p>${description}</p>
          <div class="meta">By ${author} | ${date}</div>
          <div class="tags">${tags}</div>
        `;
        grid.appendChild(card);
      }catch(e){console.error('Error loading markdown', file.name, e);}
    }
  }catch(e){
    console.error('Error fetching articles', e);
    grid.innerHTML='<p class="small">Unable to load articles.</p>';
  }
})();
</script>
</body>
</html>
